{"ts":1347062122150,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\nvar startTS;\n\nvoid setup(){\n    size(600,100);\n    smooth();\n}\n\nvoid draw(){\n    if(bg == 'black'){\n        background(0);\n    } else {\n        background(255);\n    }\n    //draw frame\n    stroke(0);\n    line(0,0,width,0);\n    line(0,0,0,height);\n    line(width-1,0,width-1,height);\n    line(0,height-1,width,height-1);\n    //update start c\n    updateStartX();\n    //update chat buffer\n    updateChat();\n    //update starting time stamp\n    if(ltype == 'time'){\n        getStartTS();\n        for(var i in chatBuffer){\n            var ts = parseInt(chatBuffer[i].time,10); \n            var text = chatBuffer[i].text.split(' ');\n            if( ts + text.length >= startTS){\n                var offset = (ts - startTS)*pixps;\n                if(offset>width){\n                    break;\n                }\n                var r = parseInt(chatBuffer[i].color.substring(1,3),16);\n                var g = parseInt(chatBuffer[i].color.substring(3,5),16);\n                var b = parseInt(chatBuffer[i].color.substring(5,7),16);\n                fill(r,g,b);\n                for(var j in text){\n                    rect(offset+(j*pixps),0,pixps,height,5);\n                }\n            }\n        }\n    } else {\n        var count = 0;\n        for(var i in chatBuffer){\n            var text = chatBuffer[i].text.split(' ');\n            if( (count + text.length)*pixps >= startx ){\n                var offset = count*pixps - startx;\n                if(offset > width){\n                    break;\n                }\n                var r = parseInt(chatBuffer[i].color.substring(1,3),16);\n                var g = parseInt(chatBuffer[i].color.substring(3,5),16);\n                var b = parseInt(chatBuffer[i].color.substring(5,7),16);\n                fill(r,g,b);\n                for(var j in text){\n                    rect(offset+(j*pixps),0,pixps,height,5);\n                }\n            }\n            count += text.length;\n        }\n    }\n}\n\nvoid getStartTS(){\n    startTS = firstTS + startx/pixps;\n}\n\nvoid updateStartX(){\n    if(mouseX>0 && mouseX < 50){\n        //left\n        startx += pixps;\n    } else if(mouseX > 550 && mouseX <600){\n        //right\n        if(startx >= pixps)\n            startx -= pixps;\n    }\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2212}]],"length":2212}
